<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width", initial-scale="1">
		<title>D2project</title>
		<link rel="stylesheet"href="/static/webjars/bootstrap/css/bootstrap.min.css">
		<script src="/static/webjars/bootstrap/js/bootstrap.min.js"></script>
		<script src="/static/js/jquery/jquery.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  		
  		<script type="text/javascript">
  		
  		
  		$(document).ready(
  				function() {
  					
  					
  					$("#registerButton").attr("disabled", true); //비활성화
  					$("#registerButton").click(function() {
  						console.log("?????");
  	  		  			
  					});
  					$("#userId").change(function(){
  						$("#registerButton").attr("disabled", true);
  					});
  					
  					$("#dupCheck").click(function() {
  						console.log($("#userId").val());
  	  		  			// DO POST
  	  		  			$.ajax({
  	  		  				type : "POST",
  	  		  				url : "/register/duplicate",
  	  		  				data : {id : $("#userId").val()},
  	  		  				success : function(result) {
  	  		  					if (result.data == "0") {
  	  		  						alert("사용가능한 아이디입니다.");
  	  		  					    $("#registerButton").attr("disabled", false);

  	  		  					} else if(result.data == "1"){
  	  		  						alert("존재하는 아이디입니다.");
  	  		  						$("#registerButton").attr("disabled", true);
  	  		  					}
  	  		  					
  	  		  				},
  	  		  				error : function(e) {
  	  		  					alert("Error!")
  	  		  					console.log("ERROR: ", e);
  	  		  				}
  	  		  			});
  					});
  					
  		});
 
  		
  		function appendBirthday(){
  			var date = new Date();
  			var year = date.getFullYear();
  			var selectValue = document.getElementById("year");
  			var optionIndex = 0;
  			for(var i=year-100;i<=year;i++){
  					selectValue.add(new Option(i+"년",i),optionIndex++);                        
  			}
  			selectValue = document.getElementById("month"); 
  			optionIndex = 0;
  			for(var i=1;i<=12;i++){
  					selectValue.add(new Option(i+"월",i),optionIndex++);
  			}
  			selectValue = document.getElementById("day");
  			optionIndex = 0;
  			for(var i=1;i<=31;i++){
  					selectValue.add(new Option(i+"일",i),optionIndex++);
  			}
  		}
		
  		function validate() {
      		var re = /^[a-zA-Z0-9]{4,12}$/ // 아이디와 패스워드가 적합한지 검사할 정규식

	       var id = document.getElementById("id");
	       var pw = document.getElementById("password");
	       var name = document.getElementById("name");
	       var sex = document.getElementById("sex");
	       var birthyear = document.getElementById("year");
	       var birthmonth = document.getElementById("month");
	       var birthday = document.getElementById("day");
	       var city = document.getElementById("city");
	       var school = document.getElementById("school");
	       var office = document.getElementById("office");
	
	       if(!check(re,id,"아이디는 4~20자의 영문 대소문자와 숫자로 입력하세요")) {
	           return false;
	       }
	
	       if(!check(re,pw,"패스워드는 8~16자의 영문 대소문자와 숫자로만 입력하세요")) {
	           return false;
	       }
	
	       if(join.pw.value != join.checkpw.value) {
	           alert("비밀번호가 다릅니다. 다시 확인해 주세요.");
	           join.checkpw.value = "";
	           join.checkpw.focus();
	           return false;
	       }
	
	       if(email.value=="") {
	           alert("이메일을 입력해 주세요");
	           email.focus();
	           return false;
	       }
	
	       if(!check(re2, email, "적합하지 않은 이메일 형식입니다.")) {
	           return false;
	       }
	
	       if(join.name.value=="") {
	           alert("이름을 입력해 주세요");
	           join.name.focus();
	           return false;
	       }
	
	       // -------------- 주민번호 -------------
	
	       for (var i=0; i<num1.value.length; i++) {
	           arrNum1[i] = num1.value.charAt(i);
	       } // 주민번호 앞자리를 배열에 순서대로 담는다.
	
	       for (var i=0; i<num2.value.length; i++) {
	           arrNum2[i] = num2.value.charAt(i);
	       } // 주민번호 뒷자리를 배열에 순서대로 담는다.
	
	       var tempSum=0;
	
	       for (var i=0; i<num1.value.length; i++) {
	           tempSum += arrNum1[i] * (2+i);
	       } // 주민번호 검사방법을 적용하여 앞 번호를 모두 계산하여 더함
	
	       for (var i=0; i<num2.value.length-1; i++) {
	           if(i>=2) {
	               tempSum += arrNum2[i] * i;
	           }
	           else {
	               tempSum += arrNum2[i] * (8+i);
	           }
	       } // 같은방식으로 앞 번호 계산한것의 합에 뒷번호 계산한것을 모두 더함
	
	       if((11-(tempSum%11))%10!=arrNum2[6]) {
	           alert("올바른 주민번호가 아닙니다.");
	           num1.value = "";
	           num2.value = "";
	           num1.focus();
	           return false;
	       }else{
	     	// ------------ 생일 자동 등록 -----------
	           if(arrNum2[0]==1 || arrNum2[0]==2) {
	               var y = parseInt(num1.value.substring(0,2));
	               var m = parseInt(num1.value.substring(2,4));
	               var d = parseInt(num1.value.substring(4,6));
	               join.years.value = 1900 + y;
	               join.month.value = m;
	               join.day.value = d;
	           }
	           else if(arrNum2[0]==3 || arrNum2[0]==4) {
	               var y = parseInt(num1.value.substring(0,2));
	               var m = parseInt(num1.value.substring(2,4));
	               var d = parseInt(num1.value.substring(4,6));
	               join.years.value == 2000 + y;
	               join.month.value = m;
	               join.day.value = d;
	           }
	       }
	
	       // 관심분야, 자기소개 미입력시 하라는 메시지 출력
	       if(join.inter[0].checked==false &&
	           join.inter[1].checked==false &&
	           join.inter[2].checked==false &&
	           join.inter[3].checked==false &&
	           join.inter[4].checked==false) {
	           alert("관심분야를 골라주세요");
	           return false;
	       }
	
	       if(join.self.value=="") {
	           alert("자기소개를 적어주세요");
	           join.self.focus();
	           return false;
	       }
	       
	       alert("회원가입이 완료되었습니다.");
	   }
	
	   function check(re, what, message) {
	       if(re.test(what.value)) {
	           return true;
	       }
	       alert(message);
	       what.value = "";
	       what.focus();
	       //return false;
	   }

  		</script>

	</head>
	<body>
<!-- Navigation -->
  <div th:block th:replace="contents/fragments/navigationBar :: navBar">
  </div>


		<div class="container reg-buffer">
			
			<div class="col-md-8">
		    <form class="form-horizontal" role="form" method="POST" action="/register/confirm/">
		        <div class="row">
		            <div class="col-md-3"></div>
		            <div class="col-md-6 reg-bottom">
		                <h2>Register</h2>
		                <hr>
		            </div>
		        </div>
		        
		        <div class="row">
		            <div class="col-md-3 field-label-responsive">
		                <label for="userId">ID</label>
		            </div>
		            <div class="col-md-6">
		                <div class="form-group">
		                    <div class="input-group mb-2 mr-sm-2 mb-sm-0">
		                        <div class="input-group-addon" style="width: 2.6rem"><i class="fa fa-user"></i></div>
		                        <input type="text" id="userId" name="userId" class="form-control" placeholder="ID" required autofocus>	                  
		                        <button id="dupCheck">중복검사</button>
		                    </div>
		                </div>
		            </div>
		            <div class="col-md-3">
		                <div class="form-control-feedback">
		                        <span class="text-danger align-middle">
		                            <!-- Put name validation error messages here -->
		                        </span>
		                </div>
		            </div>
		        </div>
		        <div class="row">
		            <div class="col-md-3 field-label-responsive">
		                <label for="user_password">비밀번호</label>
		            </div>
		            <div class="col-md-6">
		                <div class="form-group has-danger">
		                    <div class="input-group mb-2 mr-sm-2 mb-sm-0">
		                        <div class="input-group-addon" style="width: 2.6rem"><i class="fa fa-key"></i></div>
		                        <input type="password" id="password" name="password" class="form-control" 
		                               placeholder="Password" required>
		                    </div>
		                </div>
		            </div>
		            <div class="col-md-3">
		                <div class="form-control-feedback">
		                        <span class="text-danger align-middle">
		                           <!-- <i class="fa fa-close"> </i> -->
		                        </span>
		                </div>
		            </div>
		        </div>
		        <div class="row">
		            <div class="col-md-3 field-label-responsive">
		                <label for="password">비밀번호 확인</label>
		            </div>
		            <div class="col-md-6">
		                <div class="form-group">
		                    <div class="input-group mb-2 mr-sm-2 mb-sm-0">
		                        <div class="input-group-addon" style="width: 2.6rem">
		                            <i class="fa fa-repeat"></i>
		                        </div>
		                        <input type="password" name="password-confirmation" class="form-control"
		                               id="password-confirm" placeholder="Password" required>
		                    </div>
		                </div>
		            </div>
		        </div>
		        <div class="row">
		            <div class="col-md-3 field-label-responsive">
		                <label for="user_name">이름</label>
		            </div>
		            <div class="col-md-6">
		                <div class="form-group">
		                    <div class="input-group mb-2 mr-sm-2 mb-sm-0">
		                        <div class="input-group-addon" style="width: 2.6rem"><i class="fa fa-user"></i></div>
		                        <input type="text" id="name" name="name" class="form-control" 
		                               placeholder="홍길동" required autofocus>
		                    </div>
		                </div>
		            </div>
		            <div class="col-md-3">
		                <div class="form-control-feedback">
		                        <span class="text-danger align-middle">
		                            <!-- Put name validation error messages here -->
		                        </span>
		                </div>
		            </div>
		        </div>
		        <div class="row">
		            <div class="col-md-3 field-label-responsive">
		                <label for="birthday">생년월일</label>
		            </div>
		            <div class="col-md-6 reg-bottom">
		                <div class="form-group">
		                    <div class="input-group mb-2 mr-sm-2 mb-sm-0">
		                        <div class="input-group-addon" style="width: 2.6rem"><i class="fa fa-user"></i></div>
		                        <input type="text" id="birthday" name="birthday" class="form-control" 
		                               placeholder="1995-07-16" required autofocus>
		                    </div>
		                </div>
		            </div>
		            <div class="col-md-3">
		                <div class="form-control-feedback">
		                        <span class="text-danger align-middle">
		                            <!-- Put name validation error messages here -->
		                        </span>
		                </div>
		            </div>
		        </div>
		        <!--
		        <div class="row">
		            <div class="col-md-3 field-label-responsive">
		                <label for="email">Email</label>
		            </div>
		            <div class="col-md-6">
		                <div class="form-group">
		                    <div class="input-group mb-2 mr-sm-2 mb-sm-0">
		                        <div class="input-group-addon" style="width: 2.6rem"><i class="fa fa-at"></i></div>
		                        <input type="text" name="email" class="form-control" id="email"
		                               placeholder="you@example.com" required autofocus>
		                    </div>
		                </div>
		            </div>
		            <div class="col-md-3">
		                <div class="form-control-feedback">
		                        <span class="text-danger align-middle">
		                            
		                        </span>
		                </div>
		            </div>
		        </div>
		    	-->
		        
		        <div class="row">
		            <div class="col-md-3"></div>
		            <div class="col-md-6">
		                <button id = "registerButton" type="submit" class="btn btn-success"><i class="fa fa-user-plus"></i> Register</button>
		            </div>
		        </div>
		    </form>
			</div>
		</div>
</body>

</html>